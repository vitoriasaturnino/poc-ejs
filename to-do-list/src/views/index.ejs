<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel='stylesheet' href='/style.css'>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
  <title>To Do List</title>
</head>
<body>
  <% if (message != "") { %>
  <section class="message message-<%= type %>">
    <p> <%= message %> </p>
    <span id="closeMessage"> <i class="bi bi-x-lg"></i> </span>
  </section>
  <% } %>

  <!-- create task form -->
  <header>
    <% if (task == null) { %>
      <%- include('./components/form',{
        titleForm: "Nova Tarefa",
        action: "create",
        value: "",
        idButton: "addButton",
        valueButton: "Adicionar"
      }) %>
    <% } else { %>
      <%- include('./components/form', {
        titleForm: "Editar Tarefa",
        action: `update/${task._id}`,
        value: task.taskDescription,
        idButton: "updateButton",
        valueButton: "Atualizar"
      }) %>
    <% } %>
  </header>

  <!-- getAll tasks loop -->
  <section id="tasks">
    <ul>
      <% tasks.forEach((task) => { %>
        <li class="check-<%= task.check %>">
          <div>
            <a href="/task-check/<%= task._id %>" class="check-<%= task.check %>"> <%= task.taskDescription %> </a>
            <span> Criado em <%= task.date.toLocaleDateString('pt-BR') %> </span>
          </div>
          <div>
            <a class="updateButton" href="/find-by-id/<%= task._id %>/update"> <i class="bi bi-pencil-square"></i> </i></a>
            <a class="deleteButton" href="/find-by-id/<%= task._id %>/delete"> <i <i class="bi bi-x-circle"></i> </a>
          </div>
        </li>
      <% }) %>
    </ul>
  </section>

  <% if (taskDelete != null) { %>
    <%- include('./components/deleteModal.ejs', {task: taskDelete}) %>
  <% } %>

  <script src="/script.js"></script>
</body>
</html>