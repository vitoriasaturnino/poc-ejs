<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel='stylesheet' href='/style.css'>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
  <title>To Do List</title>
</head>
<body>
  <% if (message != "") { %>
  <section class="message message-<%= type %>">
    <p> <%= message %> </p>
    <span id="closeMessage"> <i class="bi bi-x-lg"></i> </span>
  </section>
  <% } %>

  <!-- create task form -->
  <header>
    <% if (task == null) { %>
      <h1>TO DO LIST</h1>
      <form action="/create" method="post">
        <input type="text" name="taskDescription" id="task" placeholder="Descreva a nova tarefa">
        <button id="addButton" type="submit">Adicionar</button>
      </form>
    <% } else { %>
      <h1>Editar Tarefa</h1>
      <form action="/update/<%= task._id %>" method="post">
        <input type="text" name="taskDescription" id="task" value="<%= task.taskDescription %>" >
        <button id="updateButton" type="submit">Atualizar</button>
      </form>
    <% } %>
  </header>

  <!-- getAll tasks loop -->
  <section id="tasks">
    <ul>
      <% tasks.forEach((task) => { %>
        <li class="check-<%= task.check %>">
          <div>
            <a href="/task-check/<%= task._id %>" class="check-<%= task.check %>"> <%= task.taskDescription %> </a>
            <span> Criado em <%= task.date.toLocaleDateString('pt-BR') %> </span>
          </div>
          <div>
            <a class="updateButton" href="/find-by-id/<%= task._id %>/update"> <i class="bi bi-pencil-square"></i> </i></a>
            <a class="deleteButton" href="/find-by-id/<%= task._id %>/delete"> <i <i class="bi bi-x-circle"></i> </a>
          </div>
        </li>
      <% }) %>
    </ul>
  </section>

  <% if (taskDelete != null) { %>
    <section id="modal">
      <div id="card">
        <div id="head">
          <h2> Confirmacao </h2>
          <a id="closeButton" href="/"> <i class="bi bi-x-lg"></i> </a>
        </div>
        <hr>
        <p> Deseja realmente excluir a task: "<%= taskDelete.taskDescription %>"</p>
        <div id="buttons">
          <a id="notButton" href="/" > NÃ£o </a>
          <a id="yesButton" href="/delete-task/<%= taskDelete._id %>"> Sim </a>
        </div>
      </div>
    </section>
  <% } %>

  <script src="/script.js"></script>
</body>
</html>